!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.tracing=n():t.tracing=n()}(window,function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=10)}([function(t,n,r){"use strict";var e,o,i,u=r(3),c="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function a(){i=!1}function p(t){if(t){if(t!==e){if(t.length!==c.length)throw new Error("Custom alphabet for shortid must be "+c.length+" unique characters. You submitted "+t.length+" characters: "+t);var n=t.split("").filter(function(t,n,r){return n!==r.lastIndexOf(t)});if(n.length)throw new Error("Custom alphabet for shortid must be "+c.length+" unique characters. These characters were not unique: "+n.join(", "));e=t,a()}}else e!==c&&(e=c,a())}function f(){return i||(i=function(){e||p(c);for(var t,n=e.split(""),r=[],o=u.nextValue();n.length>0;)o=u.nextValue(),t=Math.floor(o*n.length),r.push(n.splice(t,1)[0]);return r.join("")}())}t.exports={get:function(){return e||c},characters:function(t){return p(t),e},seed:function(t){u.seed(t),o!==t&&(a(),o=t)},lookup:function(t){return f()[t]},shuffled:f}},function(t,n,r){"use strict";t.exports=r(2)},function(t,n,r){"use strict";var e=r(0),o=r(4),i=r(8),u=r(9)||0;function c(){return o(u)}t.exports=c,t.exports.generate=c,t.exports.seed=function(n){return e.seed(n),t.exports},t.exports.worker=function(n){return u=n,t.exports},t.exports.characters=function(t){return void 0!==t&&e.characters(t),e.shuffled()},t.exports.isValid=i},function(t,n,r){"use strict";var e=1;t.exports={nextValue:function(){return(e=(9301*e+49297)%233280)/233280},seed:function(t){e=t}}},function(t,n,r){"use strict";var e,o,i=r(5),u=(r(0),1459707606518),c=6;t.exports=function(t){var n="",r=Math.floor(.001*(Date.now()-u));return r===o?e++:(e=0,o=r),n+=i(c),n+=i(t),e>0&&(n+=i(e)),n+=i(r)}},function(t,n,r){"use strict";var e=r(0),o=r(6),i=r(7);t.exports=function(t){for(var n,r=0,u="";!n;)u+=i(o,e.get(),1),n=t<Math.pow(16,r+1),r++;return u}},function(t,n,r){"use strict";var e,o="object"==typeof window&&(window.crypto||window.msCrypto);e=o&&o.getRandomValues?function(t){return o.getRandomValues(new Uint8Array(t))}:function(t){for(var n=[],r=0;r<t;r++)n.push(Math.floor(256*Math.random()));return n},t.exports=e},function(t,n){t.exports=function(t,n,r){var e=(2<<Math.log(n.length-1)/Math.LN2)-1,o=Math.ceil(1.6*e*r/n.length);r=+r;for(var i="";;)for(var u=t(o),c=0;c<o;c++){var a=u[c]&e;if(n[a]&&(i+=n[a]).length===r)return i}}},function(t,n,r){"use strict";var e=r(0);t.exports=function(t){return!(!t||"string"!=typeof t||t.length<6||new RegExp("[^"+e.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(t))}},function(t,n,r){"use strict";t.exports=0},function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"SPAN_KIND",function(){return u}),r.d(e,"SPAN_KIND_RPC_CLIENT",function(){return c}),r.d(e,"SPAN_KIND_RPC_SERVER",function(){return a}),r.d(e,"SPAN_KIND_MESSAGING_PRODUCER",function(){return p}),r.d(e,"SPAN_KIND_MESSAGING_CONSUMER",function(){return f}),r.d(e,"ERROR",function(){return s}),r.d(e,"COMPONENT",function(){return l}),r.d(e,"SAMPLING_PRIORITY",function(){return _}),r.d(e,"PEER_SERVICE",function(){return y}),r.d(e,"PEER_HOSTNAME",function(){return h}),r.d(e,"PEER_ADDRESS",function(){return d}),r.d(e,"PEER_HOST_IPV4",function(){return g}),r.d(e,"PEER_HOST_IPV6",function(){return O}),r.d(e,"PEER_PORT",function(){return v}),r.d(e,"HTTP_URL",function(){return E}),r.d(e,"HTTP_METHOD",function(){return T}),r.d(e,"HTTP_STATUS_CODE",function(){return m}),r.d(e,"MESSAGE_BUS_DESTINATION",function(){return w}),r.d(e,"DB_INSTANCE",function(){return N}),r.d(e,"DB_STATEMENT",function(){return b}),r.d(e,"DB_TYPE",function(){return S}),r.d(e,"DB_USER",function(){return x});var o,i=function(){return function(t){this.buffer=t}}(),u="span.kind",c="client",a="server",p="producer",f="consumer",s="error",l="component",_="sampling.priority",y="peer.service",h="peer.hostname",d="peer.address",g="peer.ipv4",O="peer.ipv6",v="peer.port",E="http.url",T="http.method",m="http.status_code",w="message_bus.destination",N="db.instance",b="db.statement",S="db.type",x="db.user";!function(t){t.ERROR="error",t.WARN="warn",t.INFO="info",t.VERBOSE="verbose",t.DEBUG="debug",t.SILLY="silly"}(o||(o={}));var P=function(){function t(t){this._span=t}return t.prototype.error=function(t,n){this._span.log({level:o.ERROR,message:t,payload:n,event:"error"})},t.prototype.warn=function(t,n){this._span.log({level:o.WARN,message:t,payload:n})},t.prototype.info=function(t,n){this._span.log({level:o.INFO,message:t,payload:n})},t.prototype.debug=function(t,n){this._span.log({level:o.DEBUG,message:t,payload:n})},t.prototype.silly=function(t,n){this._span.log({level:o.SILLY,message:t,payload:n})},t}(),R=function(){function t(){this.logger=new P(this)}return t.prototype.context=function(){return this._context()},t.prototype.tracer=function(){return this._tracer()},t.prototype.setOperationName=function(t){return this._setOperationName(t),this},t.prototype.setBaggageItem=function(t,n){return this._setBaggageItem(t,n),this},t.prototype.getBaggageItem=function(t){return this._getBaggageItem(t)},t.prototype.setTag=function(t,n){var r;return this._addTags(((r={})[t]=n,r)),this},t.prototype.addTags=function(t){return this._addTags(t),this},t.prototype.log=function(t,n){return this._log(t,n),this},t.prototype.logEvent=function(t,n){return this._log({event:t,payload:n})},t.prototype.finish=function(t){this._finish(t)},t.prototype._context=function(){return V},t.prototype._tracer=function(){return F},t.prototype._setOperationName=function(t){},t.prototype._setBaggageItem=function(t,n){},t.prototype._getBaggageItem=function(t){},t.prototype._addTags=function(t){},t.prototype._log=function(t,n){},t.prototype._finish=function(t){},t}(),I=function(){function t(){}return t.prototype.toTraceId=function(){return""},t.prototype.toSpanId=function(){return""},t}(),j="child_of",A="follows_from",M=function(){function t(t,n){this._type=t,this._referencedContext=n instanceof R?n.context():n}return t.prototype.type=function(){return this._type},t.prototype.referencedContext=function(){return this._referencedContext},t}();function C(t){return t instanceof R&&(t=t.context()),new M(j,t)}function D(t){return t instanceof R&&(t=t.context()),new M(A,t)}var B=function(){function t(){}return t.prototype.startSpan=function(t,n){if(void 0===n&&(n={}),n.childOf){var r=C(n.childOf);n.references?n.references.push(r):n.references=[r],delete n.childOf}return this._startSpan(t,n)},t.prototype.inject=function(t,n,r){return t instanceof R&&(t=t.context()),this._inject(t,n,r)},t.prototype.extract=function(t,n){return this._extract(t,n)},t.prototype._startSpan=function(t,n){return U},t.prototype._inject=function(t,n,r){},t.prototype._extract=function(t,n){return V},t}(),L=B,F=null,V=null,U=null;var G,H=(G=function(t,n){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)},function(t,n){function r(){this.constructor=t}G(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),Y=new L,k=null,K=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return H(n,t),n.prototype.startSpan=function(){var t=k||Y;return t.startSpan.apply(t,arguments)},n.prototype.inject=function(){var t=k||Y;return t.inject.apply(t,arguments)},n.prototype.extract=function(){var t=k||Y;return t.extract.apply(t,arguments)},n}(L));function W(t){k=t}function q(){return K}F=new L,U=new R,V=new I;var X=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),$=function(){return($=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},z=function(t){function n(n,r){var e=t.call(this)||this;return e._references=[],e._tags={},e._logs=[],e.__tracer=n,e.__context=r,e}return X(n,t),n.prototype.tracer=function(){return t.prototype.tracer.call(this)},n.prototype.start=function(t){this._startTime=t||Date.now()},n.prototype.addReference=function(t){this._references.push(t)},n.prototype.getTag=function(t){return this._tags[t]},n.prototype._context=function(){return this.__context},n.prototype._tracer=function(){return this.__tracer},n.prototype._setOperationName=function(t){this._operationName=t},n.prototype._addTags=function(t){this._tags=$({},this._tags,t)},n.prototype._log=function(t,n){this._logs.push({fields:t,timestamp:n||Date.now()})},n.prototype._finish=function(t){this._finishTime=t||Date.now()},n}(R),J=z,Q=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),Z=function(t){function n(n,r){var e=t.call(this)||this;return e._traceId=n,e._spanId=r,e}return Q(n,t),n.prototype.toTraceId=function(){return this._traceId},n.prototype.toSpanId=function(){return this._spanId},n}(I),tt=r(1),nt=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),rt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.spanClass=J,n}return nt(n,t),n.prototype.startSpan=function(n,r){return void 0===r&&(r={}),t.prototype.startSpan.call(this,n,r)},n.prototype._startSpan=function(t,n){var r=n.references?n.references[0]:null,e=r?r.referencedContext().toTraceId():tt.generate(),o=tt.generate(),i=new Z(e,o),u=new this.spanClass(this,i);if(u.setOperationName(t),n.tags&&u.addTags(n.tags),n.references)for(var c=0,a=n.references;c<a.length;c++){var p=a[c];u.addReference(p)}return u.start(n.startTime),u},n.prototype._inject=function(t,n,r){},n.prototype._extract=function(t,n){return V},n}(B),et=rt,ot=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),it=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return ot(n,t),n.prototype.tracer=function(){return t.prototype.tracer.call(this)},n.prototype._log=function(t,n){var r=this.tracer(),o=this.getTag(e.COMPONENT);r.forward(o,t)},n}(J),ut=it,ct=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),at=function(t){function n(n){var r=t.call(this)||this;return r.spanClass=ut,r.debugInstances={},r.debugFactory=n,r}return ct(n,t),n.prototype.startSpan=function(n,r){return void 0===r&&(r={}),t.prototype.startSpan.call(this,n,r)},n.prototype.forward=function(t,n){t=t||"NO-COMPONENT";var r=this.debugInstances[t];r||(r=this.debugInstances[t]=this.debugFactory(t));var e=n.level||"NO-LEVEL",o=n.message||"NO-MESSAGE";n.payload?r("["+e+"] "+o,n.payload):r("["+e+"] "+o)},n}(et),pt=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),ft=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return pt(n,t),n.prototype.tracer=function(){return t.prototype.tracer.call(this)},n.prototype._log=function(t,n){var r=this.tracer(),o=this.getTag(e.COMPONENT);r.forward(o,t)},n}(J),st=ft,lt=function(){var t=function(n,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(n,r)};return function(n,r){function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),_t=function(t){function n(n){var r=t.call(this)||this;return r.spanClass=st,r.winstonLogger=n,r}return lt(n,t),n.prototype.startSpan=function(n,r){return void 0===r&&(r={}),t.prototype.startSpan.call(this,n,r)},n.prototype.forward=function(t,n){t=t||"NO-COMPONENT";var r=n.level||"NO-LEVEL",e=n.message||"NO-MESSAGE";this.winstonLogger.log({component:t,level:r,message:e,payload:n.payload})},n}(et),yt="__COMPONENT_NAME__";var ht={Trace:function(t){return function(n,r,o){var i=o.value;return t.operationName=t.operationName||r,o.value=function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var u=r[0]instanceof R?r[0]:null,c=u?u.tracer():q(),a={};if("function"==typeof t.relationType)try{var p=t.relationType.apply(this,r);t.relationType=p}catch(n){throw console.error('Unexpected error in traces method "'+t.operationName+'"s relation type handler'),n}var f=this[yt];if(f&&(a.tags=((n={})[e.COMPONENT]=f,n)),"childOf"==t.relationType||"followsFrom"==t.relationType){if(!u)throw new Error('Traced method "'+t.operationName+'"s first argument must be a span');"childOf"==t.relationType?a.childOf=u:"followsFrom"==t.relationType&&(a.references=[D(u)])}var s=c.startSpan(t.operationName,a);r.splice(0,1,s);try{var l=i.apply(this,r);return t.autoFinish?"object"==typeof l&&l.then&&l.catch?l.then(function(t){return s.finish(),t}).catch(function(t){throw s.logger.error(t&&t.message||"Unknown error",t),s.setTag(e.ERROR,!0),s.finish(),t}):(s.finish(),l):l}catch(t){throw s.logger.error(t&&t.message||"Unknown error",t),s.setTag(e.ERROR,!0),s.finish(),t}},o}},ComponentName:function(t){return function(n){n.prototype[yt]=t}}};r.d(n,"BasicSpan",function(){return z}),r.d(n,"BasicTracer",function(){return rt}),r.d(n,"DebugTracer",function(){return at}),r.d(n,"DebugSpan",function(){return it}),r.d(n,"WinstonTracer",function(){return _t}),r.d(n,"WinstonSpan",function(){return ft}),r.d(n,"decorators",function(){return ht}),r.d(n,"BinaryCarrier",function(){return i}),r.d(n,"Reference",function(){return M}),r.d(n,"SpanContext",function(){return I}),r.d(n,"Span",function(){return R}),r.d(n,"Tracer",function(){return B}),r.d(n,"Tags",function(){return e}),r.d(n,"initGlobalTracer",function(){return W}),r.d(n,"globalTracer",function(){return q}),r.d(n,"FORMAT_BINARY",function(){return"binary"}),r.d(n,"FORMAT_TEXT_MAP",function(){return"text_map"}),r.d(n,"FORMAT_HTTP_HEADERS",function(){return"http_headers"}),r.d(n,"REFERENCE_CHILD_OF",function(){return j}),r.d(n,"REFERENCE_FOLLOWS_FROM",function(){return A}),r.d(n,"childOf",function(){return C}),r.d(n,"followsFrom",function(){return D})}])});