module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e,n){"use strict";var r,o,i,c=n(3),a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function u(){i=!1}function s(t){if(t){if(t!==r){if(t.length!==a.length)throw new Error("Custom alphabet for shortid must be "+a.length+" unique characters. You submitted "+t.length+" characters: "+t);var e=t.split("").filter(function(t,e,n){return e!==n.lastIndexOf(t)});if(e.length)throw new Error("Custom alphabet for shortid must be "+a.length+" unique characters. These characters were not unique: "+e.join(", "));r=t,u()}}else r!==a&&(r=a,u())}function p(){return i||(i=function(){r||s(a);for(var t,e=r.split(""),n=[],o=c.nextValue();e.length>0;)o=c.nextValue(),t=Math.floor(o*e.length),n.push(e.splice(t,1)[0]);return n.join("")}())}t.exports={get:function(){return r||a},characters:function(t){return s(t),r},seed:function(t){c.seed(t),o!==t&&(u(),o=t)},lookup:function(t){return p()[t]},shuffled:p}},function(t,e,n){"use strict";t.exports=n(2)},function(t,e,n){"use strict";var r=n(0),o=n(4),i=n(10),c=n(11)||0;function a(){return o(c)}t.exports=a,t.exports.generate=a,t.exports.seed=function(e){return r.seed(e),t.exports},t.exports.worker=function(e){return c=e,t.exports},t.exports.characters=function(t){return void 0!==t&&r.characters(t),r.shuffled()},t.exports.isValid=i},function(t,e,n){"use strict";var r=1;t.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(t){r=t}}},function(t,e,n){"use strict";var r,o,i=n(5),c=(n(0),1459707606518),a=6;t.exports=function(t){var e="",n=Math.floor(.001*(Date.now()-c));return n===o?r++:(r=0,o=n),e+=i(a),e+=i(t),r>0&&(e+=i(r)),e+=i(n)}},function(t,e,n){"use strict";var r=n(0),o=n(6),i=n(9);t.exports=function(t){for(var e,n=0,c="";!e;)c+=i(o,r.get(),1),e=t<Math.pow(16,n+1),n++;return c}},function(t,e,n){t.exports=n(7)},function(t,e,n){var r=n(8);if(r.randomFillSync){var o={};t.exports=function(t){var e=o[t];return e||(e=Buffer.allocUnsafe(t),t<=255&&(o[t]=e)),r.randomFillSync(e)}}else t.exports=r.randomBytes},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=function(t,e,n){var r=(2<<Math.log(e.length-1)/Math.LN2)-1,o=Math.ceil(1.6*r*n/e.length);n=+n;for(var i="";;)for(var c=t(o),a=0;a<o;a++){var u=c[a]&r;if(e[u]&&(i+=e[u]).length===n)return i}}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){return!(!t||"string"!=typeof t||t.length<6||new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(t))}},function(t,e,n){"use strict";var r=n(12),o=0;!r.isMaster&&r.worker&&(o=r.worker.id),t.exports=parseInt(process.env.NODE_UNIQUE_ID||o,10)},function(t,e){t.exports=require("cluster")},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"SPAN_KIND",function(){return l}),n.d(r,"SPAN_KIND_RPC_CLIENT",function(){return h}),n.d(r,"SPAN_KIND_RPC_SERVER",function(){return _}),n.d(r,"SPAN_KIND_MESSAGING_PRODUCER",function(){return g}),n.d(r,"SPAN_KIND_MESSAGING_CONSUMER",function(){return d}),n.d(r,"ERROR",function(){return y}),n.d(r,"COMPONENT",function(){return v}),n.d(r,"SAMPLING_PRIORITY",function(){return O}),n.d(r,"PEER_SERVICE",function(){return m}),n.d(r,"PEER_HOSTNAME",function(){return b}),n.d(r,"PEER_ADDRESS",function(){return S}),n.d(r,"PEER_HOST_IPV4",function(){return x}),n.d(r,"PEER_HOST_IPV6",function(){return E}),n.d(r,"PEER_PORT",function(){return w}),n.d(r,"HTTP_URL",function(){return I}),n.d(r,"HTTP_METHOD",function(){return T}),n.d(r,"HTTP_STATUS_CODE",function(){return N}),n.d(r,"MESSAGE_BUS_DESTINATION",function(){return R}),n.d(r,"DB_INSTANCE",function(){return P}),n.d(r,"DB_STATEMENT",function(){return C}),n.d(r,"DB_TYPE",function(){return j}),n.d(r,"DB_USER",function(){return L});var o={};n.r(o),n.d(o,"BinaryCarrier",function(){return f}),n.d(o,"Reference",function(){return G}),n.d(o,"SpanContext",function(){return M}),n.d(o,"Span",function(){return F}),n.d(o,"Tracer",function(){return Y}),n.d(o,"Tags",function(){return r}),n.d(o,"initGlobalTracer",function(){return et}),n.d(o,"globalTracer",function(){return nt}),n.d(o,"FORMAT_BINARY",function(){return D}),n.d(o,"FORMAT_TEXT_MAP",function(){return B}),n.d(o,"FORMAT_HTTP_HEADERS",function(){return k}),n.d(o,"REFERENCE_CHILD_OF",function(){return U}),n.d(o,"REFERENCE_FOLLOWS_FROM",function(){return H}),n.d(o,"childOf",function(){return V}),n.d(o,"followsFrom",function(){return Q});var i={};n.r(i),n.d(i,"BaseReporter",function(){return yt}),n.d(i,"DebugReporter",function(){return mt}),n.d(i,"WinstonReporter",function(){return St}),n.d(i,"InMemoryReporter",function(){return Et}),n.d(i,"SpanFilterProxyReporter",function(){return It}),n.d(i,"LogFilterProxyReporter",function(){return Rt}),n.d(i,"SpanComponentTagFilterProxyReporter",function(){return Lt}),n.d(i,"LogLevelFilterProxyReporter",function(){return Mt});var c={};n.r(c),n.d(c,"ComponentName",function(){return Bt}),n.d(c,"default",function(){return kt}),n.d(c,"getComponentName",function(){return Ut});var a={};n.r(a),n.d(a,"Trace",function(){return Gt}),n.d(a,"default",function(){return Vt}),n.d(a,"TraceAsync",function(){return Qt}),n.d(a,"ChildOfRelationHandler",function(){return Yt}),n.d(a,"FollowFromRelationHandler",function(){return qt}),n.d(a,"NewTraceRelationHandler",function(){return Kt});var u={};n.r(u),n.d(u,"Trace",function(){return a}),n.d(u,"ComponentName",function(){return c});var s={};n.r(s),n.d(s,"reporters",function(){return i}),n.d(s,"decorators",function(){return u}),n.d(s,"SpanContext",function(){return it}),n.d(s,"Span",function(){return st}),n.d(s,"Tracer",function(){return dt});var p,f=function(){return function(t){this.buffer=t}}(),l="span.kind",h="client",_="server",g="producer",d="consumer",y="error",v="component",O="sampling.priority",m="peer.service",b="peer.hostname",S="peer.address",x="peer.ipv4",E="peer.ipv6",w="peer.port",I="http.url",T="http.method",N="http.status_code",R="message_bus.destination",P="db.instance",C="db.statement",j="db.type",L="db.user";!function(t){t.ERROR="error",t.WARN="warn",t.INFO="info",t.VERBOSE="verbose",t.DEBUG="debug",t.SILLY="silly"}(p||(p={}));var A=function(){function t(t){this._span=t}return t.prototype.error=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._span.log({level:p.ERROR,message:t,payload:e,event:"error"})},t.prototype.warn=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._span.log({level:p.WARN,message:t,payload:e})},t.prototype.info=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._span.log({level:p.INFO,message:t,payload:e})},t.prototype.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._span.log({level:p.DEBUG,message:t,payload:e})},t.prototype.silly=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._span.log({level:p.SILLY,message:t,payload:e})},t}(),F=function(){function t(){this.logger=new A(this)}return t.prototype.context=function(){return this._context()},t.prototype.tracer=function(){return this._tracer()},t.prototype.setOperationName=function(t){return this._setOperationName(t),this},t.prototype.setBaggageItem=function(t,e){return this._setBaggageItem(t,e),this},t.prototype.getBaggageItem=function(t){return this._getBaggageItem(t)},t.prototype.setTag=function(t,e){var n;return this._addTags(((n={})[t]=e,n)),this},t.prototype.addTags=function(t){return this._addTags(t),this},t.prototype.log=function(t,e){return this._log(t,e),this},t.prototype.logEvent=function(t,e){return this._log({event:t,payload:e})},t.prototype.finish=function(t){this._finish(t)},t.prototype._context=function(){return W},t.prototype._tracer=function(){return K},t.prototype._setOperationName=function(t){},t.prototype._setBaggageItem=function(t,e){},t.prototype._getBaggageItem=function(t){},t.prototype._addTags=function(t){},t.prototype._log=function(t,e){},t.prototype._finish=function(t){},t}(),M=function(){function t(){}return t.prototype.toTraceId=function(){return""},t.prototype.toSpanId=function(){return""},t}(),D="binary",B="text_map",k="http_headers",U="child_of",H="follows_from",G=function(){function t(t,e){this._type=t,this._referencedContext=e instanceof F?e.context():e}return t.prototype.type=function(){return this._type},t.prototype.referencedContext=function(){return this._referencedContext},t}();function V(t){return t instanceof F&&(t=t.context()),new G(U,t)}function Q(t){return t instanceof F&&(t=t.context()),new G(H,t)}var Y=function(){function t(){}return t.prototype.startSpan=function(t,e){if(void 0===e&&(e={}),e.childOf){var n=V(e.childOf);e.references?e.references.push(n):e.references=[n],delete e.childOf}return this._startSpan(t,e)},t.prototype.inject=function(t,e,n){return t instanceof F&&(t=t.context()),this._inject(t,e,n)},t.prototype.extract=function(t,e){return this._extract(t,e)},t.prototype._startSpan=function(t,e){return $},t.prototype._inject=function(t,e,n){},t.prototype._extract=function(t,e){return W},t}(),q=Y,K=null,W=null,$=null;var J,X=(J=function(t,e){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}J(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),z=new q,Z=null,tt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.startSpan=function(){var t=Z||z;return t.startSpan.apply(t,arguments)},e.prototype.inject=function(){var t=Z||z;return t.inject.apply(t,arguments)},e.prototype.extract=function(){var t=Z||z;return t.extract.apply(t,arguments)},e}(q));function et(t){Z=t}function nt(){return tt}K=new q,$=new F,W=new M;var rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ot=function(){return(ot=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},it=function(t){function e(e,n){var r=t.call(this)||this;return r._baggageItems={},r._traceId=e,r._spanId=n,r}return rt(e,t),e.prototype.toTraceId=function(){return this._traceId},e.prototype.toSpanId=function(){return this._spanId},e.prototype.toJSON=function(){return{traceId:this._traceId,spanId:this._spanId,baggageItems:this._baggageItems}},e.prototype.addBaggageItems=function(t){this._baggageItems=ot({},this._baggageItems,t)},Object.defineProperty(e.prototype,"baggageItems",{get:function(){return this._baggageItems},enumerable:!0,configurable:!0}),e}(M),ct=it,at=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ut=function(){return(ut=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},st=function(t){function e(e,n){var r=t.call(this)||this;return r._references=[],r._tags={},r._logs=[],r.__tracer=e,r.__context=n,r}return at(e,t),e.prototype.tracer=function(){return t.prototype.tracer.call(this)},e.prototype.start=function(t){this._startTime=t||Date.now()},e.prototype.addReference=function(t){this._references.push(t)},e.prototype.getTag=function(t){return this._tags[t]},e.prototype.toJSON=function(){return{context:this.__context,operationName:this._operationName,startTime:this._startTime,finishTime:this._finishTime,references:this._references.map(function(t){return{type:t.type(),referencedContext:t.referencedContext()}}),tags:this._tags,logs:this._logs}},e.prototype._context=function(){return this.__context},e.prototype._tracer=function(){return this.__tracer},e.prototype._setOperationName=function(t){this._operationName=t},e.prototype._addTags=function(t){this._tags=ut({},this._tags,t)},e.prototype._log=function(t,e){var n=this,r={fields:t,timestamp:e||Date.now()};this._logs.push(r),this.__tracer.reporters.forEach(function(t){t.accepts.spanLog&&t.recieveSpanLog(n,r)})},e.prototype._finish=function(t){var e=this;this._finishTime=t||Date.now(),this.__tracer.reporters.forEach(function(t){t.accepts.spanFinish&&t.recieveSpanFinish(e)})},e.prototype._setBaggageItem=function(t,e){var n;this.__context.addBaggageItems(((n={})[t]=e,n))},e.prototype._getBaggageItem=function(t){return this.__context.baggageItems[t]},e}(F),pt=st,ft=n(1),lt="__TRACE_ID__",ht="__SPAN_ID__";var _t,gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._reporters=[],e}return gt(e,t),Object.defineProperty(e.prototype,"reporters",{get:function(){return this._reporters},enumerable:!0,configurable:!0}),e.prototype.addReporter=function(t){this._reporters.push(t)},e.prototype.removeReporter=function(t){var e=this._reporters.indexOf(t);if(e>-1){var n=this._reporters[e];return this._reporters.splice(e,1),n.close(),!0}return!1},e.prototype.startSpan=function(e,n){return void 0===n&&(n={}),t.prototype.startSpan.call(this,e,n)},e.prototype._startSpan=function(t,e){var n=e.references?e.references[0]:null,r=n?n.referencedContext():null,o=r?r.toTraceId():ft.generate(),i=ft.generate(),c=new ct(o,i);r&&r.baggageItems&&c.addBaggageItems(r.baggageItems);var a=new pt(this,c);if(a.setOperationName(t),e.tags&&a.addTags(e.tags),e.references)for(var u=0,s=e.references;u<s.length;u++){var p=s[u];a.addReference(p)}return a.start(e.startTime),this._reporters.forEach(function(t){t.accepts.spanCreate&&t.recieveSpanCreate(a)}),a},e.prototype._inject=function(t,e,n){switch(e){case"plainObject":return function(t,e){"object"!=typeof e?console.error("Could not inject context to plain object, carrier is not object.",e):(e[lt]=t.toTraceId(),e[ht]=t.toSpanId())}(t,n);default:console.error('Could not inject context into carrier, unknown format "'+e+'"',n)}},e.prototype._extract=function(t,e){var n,r;switch(t){case"plainObject":var o=function(t){var e,n;return"object"!=typeof t?console.error("Could not extract context from plain object, unexpected carrier",t):(e=t[lt],n=t[ht],delete t[lt],delete t[ht]),{traceId:e,spanId:n}}(e);n=o.traceId,r=o.spanId;break;default:console.error('Could not extract context from carrier, unknown carrier format "'+t+'"',e)}if(n&&r)return new ct(n,r)},e}(Y),yt=function(){function t(){this.accepts={spanCreate:!1,spanLog:!1,spanFinish:!1}}return t.prototype.recieveSpanCreate=function(t){},t.prototype.recieveSpanLog=function(t,e){},t.prototype.recieveSpanFinish=function(t){},t.prototype.close=function(){},t}(),vt=yt,Ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mt=function(t){function e(e){var n=t.call(this)||this;return n.accepts={spanCreate:!1,spanLog:!0,spanFinish:!1},n.debugInstances={},n.debugFactory=e,n}return Ot(e,t),e.prototype.recieveSpanLog=function(t,e){var n=t.getTag(r.COMPONENT)||"NO-COMPONENT",o=this.debugInstances[n];o||(o=this.debugInstances[n]=this.debugFactory(n));var i=e.fields.level||"NO-LEVEL",c=e.fields.message||"NO-MESSAGE";e.fields.payload?o.apply(void 0,["["+i+"] "+c].concat(e.fields.payload)):o("["+i+"] "+c)},e.prototype.close=function(){for(var t in this.debugInstances){this.debugInstances[t].destroy()}this.debugInstances={}},e}(vt),bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),St=function(t){function e(e){var n=t.call(this)||this;return n.accepts={spanCreate:!1,spanLog:!0,spanFinish:!1},n.winstonLogger=e,n}return bt(e,t),e.prototype.recieveSpanLog=function(t,e){var n=t.getTag(r.COMPONENT)||"NO-COMPONENT",o=e.fields.level||"NO-LEVEL",i=e.fields.message||"NO-MESSAGE";this.winstonLogger.log({component:n,level:o,message:i,payload:e.fields.payload})},e.prototype.close=function(){},e}(vt),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.accepts={spanCreate:!0,spanLog:!1,spanFinish:!1},e.spans=[],e}return xt(e,t),e.prototype.recieveSpanCreate=function(t){this.spans.push(t)},e.prototype.close=function(){this.spans=[]},e}(vt),wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(t){function e(e,n){var r=t.call(this)||this;return r._predicate=function(){return!0},r._target=e,"function"==typeof n&&(r._predicate=n),r.accepts.spanCreate=e.accepts.spanCreate,r.accepts.spanLog=e.accepts.spanLog,r.accepts.spanFinish=e.accepts.spanFinish,r}return wt(e,t),e.prototype.recieveSpanCreate=function(t){return!!this.testSpan(t)&&this._target.recieveSpanCreate(t)},e.prototype.recieveSpanLog=function(t,e){return!!this.testSpan(t)&&this._target.recieveSpanLog(t,e)},e.prototype.recieveSpanFinish=function(t){return!!this.testSpan(t)&&this._target.recieveSpanFinish(t)},e.prototype.testSpan=function(t){return this._predicate(t)},e.prototype.close=function(){this._target.close(),this._target=null},e}(vt),Tt=It,Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(t){function e(e,n){var r=t.call(this)||this;return r._predicate=function(){return!0},r._target=e,"function"==typeof n&&(r._predicate=n),r.accepts.spanCreate=e.accepts.spanCreate,r.accepts.spanLog=e.accepts.spanLog,r.accepts.spanFinish=e.accepts.spanFinish,r}return Nt(e,t),e.prototype.recieveSpanCreate=function(t){return this._target.recieveSpanCreate(t)},e.prototype.recieveSpanLog=function(t,e){return!!this.testSpanLog(t,e)&&this._target.recieveSpanLog(t,e)},e.prototype.recieveSpanFinish=function(t){return this._target.recieveSpanFinish(t)},e.prototype.testSpanLog=function(t,e){return this._predicate(t,e)},e.prototype.close=function(){this._target.close(),this._target=null},e}(vt),Pt=Rt,Ct=function(){function t(t){this.updateQuery(t)}return t.prototype.updateQuery=function(t){this._matchQuery=t,this.setupRegexes()},t.prototype.setupRegexes=function(){var t;this._regexes={names:[],skips:[]};var e=("string"==typeof this._matchQuery?this._matchQuery:"").split(/[\s,]+/),n=e.length;for(t=0;t<n;t++)if(e[t]){var r=e[t].replace(/\*/g,".*?");"-"===r[0]?this._regexes.skips.push(new RegExp("^"+r.substr(1)+"$")):this._regexes.names.push(new RegExp("^"+r+"$"))}},t.prototype.test=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=this._regexes.skips.length;e<n;e++)if(this._regexes.skips[e].test(t))return!1;for(e=0,n=this._regexes.names.length;e<n;e++)if(this._regexes.names[e].test(t))return!0;return!1},t}(),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.matcher=new Ct(n),r}return jt(e,t),e.prototype.updateQuery=function(t){this.matcher.updateQuery(t)},e.prototype.testSpan=function(t){return this.matcher.test(t.getTag(r.COMPONENT))},e}(Tt),At=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=((_t={})[p.ERROR]=0,_t[p.WARN]=1,_t[p.INFO]=2,_t[p.DEBUG]=3,_t[p.SILLY]=4,_t),Mt=function(t){function e(e,n){var r=t.call(this,e)||this;return r._logLevel=n,r}return At(e,t),e.prototype.updateLevel=function(t){this._logLevel=t},e.prototype.testSpanLog=function(t,e){return Ft[e.fields.level]<=Ft[this._logLevel]},e}(Pt),Dt="__COMPONENT_NAME__";function Bt(t){return function(e){e.prototype[Dt]=t}}var kt=Bt;function Ut(t){return t[Dt]}var Ht=function(){return(Ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Gt(t){return function(e,n,o){var i=o.value;t.operationName=t.operationName||n;var c=t;if("custom"!=t.relation)switch(t.relation){case"childOf":c.handler=Yt;break;case"followsFrom":c.handler=qt;break;case"newTrace":c.handler=Kt;break;default:throw new Error('Unexpected relation type "'+t.relation+'"')}return o.value=function(){for(var e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=n[0]instanceof F?n[0]:null,u=a?a.tracer():nt(),s={};try{var p=c.handler.apply(this,n);s=Ht({},s,p)}catch(e){throw console.error('Unexpected error in traced method "'+t.operationName+'"s relation handler'),e}var f=Ut(this);f&&(s.tags=Ht(((e={})[r.COMPONENT]=f,e),s));var l=u.startSpan(t.operationName,s);n.splice(0,1,l);try{var h=i.apply(this,n);return t.autoFinish?"object"==typeof h&&h.then&&h.catch?h.then(function(t){return l.finish(),t}).catch(function(t){throw l.logger.error(t&&t.message||"Unknown error",t),l.setTag(r.ERROR,!0),l.finish(),t}):(l.finish(),h):h}catch(t){throw l.logger.error(t&&t.message||"Unknown error",t),l.setTag(r.ERROR,!0),l.finish(),t}},o}}var Vt=Gt;function Qt(t){return Gt(Ht({},t,{autoFinish:!0}))}function Yt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!t)throw new Error("Traced method's first argument must be a span");return{childOf:t.context()}}function qt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!t)throw new Error("Traced method's first argument must be a span");return{references:[Q(t.context())]}}function Kt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return{}}n.d(e,"opentracing",function(){return o}),n.d(e,"stalk",function(){return s})}]);